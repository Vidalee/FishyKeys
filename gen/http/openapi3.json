{"openapi":"3.0.3","info":{"title":"FishyKeys API","description":"The FishyKeys API for key management","version":"1.0"},"servers":[{"url":"http://localhost:8080"}],"paths":{"/key_management/create_master_key":{"post":{"tags":["key_management"],"summary":"create_master_key key_management","description":"Create a new master key and split it into shares","operationId":"key_management#create_master_key","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMasterKeyRequestBody"},"example":{"min_shares":3,"total_shares":5}}}},"responses":{"201":{"description":"Created response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMasterKeyResponseBody"},"example":{"shares":["Repudiandae blanditiis id cupiditate unde eos.","Sit ratione.","Et ut magnam labore molestiae."]}}}},"400":{"description":"invalid_parameters: Bad Request response.","content":{"application/json":{"schema":{"type":"string","example":"Vero voluptatem."},"example":"Cumque amet et."}}},"409":{"description":"key_already_exists: Conflict response.","content":{"application/json":{"schema":{"type":"string","example":"Voluptate dolorem."},"example":"Magni veniam occaecati."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Amet sint est eligendi aut quae vel."},"example":"Excepturi dolorum sed consequatur eos doloribus sit."}}}}}},"/key_management/share":{"delete":{"tags":["key_management"],"summary":"delete_share key_management","description":"Delete a share from the key management system","operationId":"key_management#delete_share","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteShareRequestBody"},"example":{"index":1}}}},"responses":{"200":{"description":"OK response."},"400":{"description":"wrong_index: Bad Request response.","content":{"application/json":{"schema":{"type":"string","example":"Voluptatem qui et."},"example":"Aut quis."}}},"404":{"description":"no_key_set: Not Found response.","content":{"application/json":{"schema":{"type":"string","example":"Consequatur illum totam officiis."},"example":"Commodi rerum quo excepturi."}}},"409":{"description":"key_already_unlocked: Conflict response.","content":{"application/json":{"schema":{"type":"string","example":"Natus dignissimos."},"example":"Maiores at et ut occaecati harum maiores."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Inventore nostrum minima et."},"example":"Ducimus eum qui est."}}}}},"post":{"tags":["key_management"],"summary":"add_share key_management","description":"Add a share to unlock the master key","operationId":"key_management#add_share","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddShareRequestBody"},"example":{"share":"EXAMPLEA5ZKwDn8Zotr3B+d+F+UzrcJ1Yhl2rU0"}}}},"responses":{"201":{"description":"Created response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddShareResponseBody"},"example":{"index":5890167680709064409,"unlocked":true}}}},"400":{"description":"wrong_shares: Bad Request response.","content":{"application/json":{"schema":{"type":"string","example":"Est laborum ut vel non nam magnam."},"example":"Asperiores architecto similique quia illo eos quasi."}}},"404":{"description":"no_key_set: Not Found response.","content":{"application/json":{"schema":{"type":"string","example":"Accusantium suscipit ipsum laborum."},"example":"Dolorem fuga cupiditate alias quis voluptatibus dignissimos."}}},"409":{"description":"key_already_unlocked: Conflict response.","content":{"application/json":{"schema":{"type":"string","example":"Eius maxime doloribus."},"example":"Doloremque possimus."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Ipsa ad est quidem corporis officia."},"example":"Quidem voluptatibus ducimus."}}}}}},"/key_management/status":{"get":{"tags":["key_management"],"summary":"get_key_status key_management","description":"Get the current status of the master key","operationId":"key_management#get_key_status","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetKeyStatusResponseBody"},"example":{"current_shares":6718364374947157668,"is_locked":false,"min_shares":7654723300438466742,"total_shares":53511470712771686}}}},"404":{"description":"no_key_set: Not Found response.","content":{"application/json":{"schema":{"type":"string","example":"Dignissimos vel."},"example":"Rerum autem rerum omnis reiciendis."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Quis occaecati enim dolore est temporibus."},"example":"Quo eveniet deleniti praesentium ex eum."}}}}}},"/users":{"get":{"tags":["users"],"summary":"list users users","description":"List all users","operationId":"users#list users","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"},"example":[{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."},{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."},{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."},{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."}]},"example":[{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."},{"created_at":"Nesciunt aut.","updated_at":"Id fuga in numquam voluptatem.","username":"Distinctio reprehenderit."}]}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Porro voluptas."},"example":"Quas ut."}}}}},"post":{"tags":["users"],"summary":"create user users","description":"Create a new user","operationId":"users#create user","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequestBody"},"example":{"password":"s3cr3t","username":"alice"}}}},"responses":{"201":{"description":"Created response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserResponseBody"},"example":{"username":"Dignissimos libero ea nobis praesentium non."}}}},"400":{"description":"invalid_input: Invalid input","content":{"application/vnd.goa.error":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"username_taken: Conflict response.","content":{"application/json":{"schema":{"type":"string","example":"Nam voluptatem maiores qui velit."},"example":"Est et expedita doloremque architecto commodi rerum."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Officia earum totam esse quaerat velit."},"example":"Nam nobis libero repudiandae."}}}}}},"/users/auth":{"post":{"tags":["users"],"summary":"auth user users","description":"Authenticate a user with username and password","operationId":"users#auth user","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequestBody"},"example":{"password":"s3cr3t","username":"alice"}}}},"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthUserResponseBody"},"example":{"token":"Occaecati nesciunt eos commodi.","username":"Sequi accusantium fugit sed."}}}},"401":{"description":"unauthorized: Unauthorized response.","content":{"application/json":{"schema":{"type":"string","example":"Sit sit in rem."},"example":"Quam modi."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Ab qui harum distinctio."},"example":"Ipsum sapiente et quia."}}}}}},"/users/{username}":{"delete":{"tags":["users"],"summary":"delete user users","description":"Delete a user by username","operationId":"users#delete user","parameters":[{"name":"username","in":"path","description":"Username of the user to delete","required":true,"schema":{"type":"string","description":"Username of the user to delete","example":"alice"},"example":"alice"}],"responses":{"200":{"description":"OK response."},"404":{"description":"user_not_found: Not Found response.","content":{"application/json":{"schema":{"type":"string","example":"Et corrupti culpa minus velit."},"example":"Ex hic placeat maxime."}}},"500":{"description":"internal_error: Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Est sit dignissimos."},"example":"Eligendi quae adipisci occaecati."}}}}}}},"components":{"schemas":{"AddShareRequestBody":{"type":"object","properties":{"share":{"type":"string","description":"One of the shares need to unlock the master key","example":"EXAMPLEA5ZKwDn8Zotr3B+d+F+UzrcJ1Yhl2rU0"}},"example":{"share":"EXAMPLEA5ZKwDn8Zotr3B+d+F+UzrcJ1Yhl2rU0"},"required":["share"]},"AddShareResponseBody":{"type":"object","properties":{"index":{"type":"integer","description":"The index of the share added","example":8868013395234815538,"format":"int64"},"unlocked":{"type":"boolean","description":"Whether the master key has been unlocked","example":true}},"example":{"index":6544681696868333548,"unlocked":true},"required":["index","unlocked"]},"AuthUserResponseBody":{"type":"object","properties":{"token":{"type":"string","description":"JWT or session token","example":"Cupiditate sint molestiae adipisci architecto."},"username":{"type":"string","description":"The username of the authenticated user","example":"Sint voluptas aspernatur."}},"example":{"token":"Itaque magnam atque est.","username":"Dolorem sed incidunt id dolore sed."}},"CreateMasterKeyRequestBody":{"type":"object","properties":{"min_shares":{"type":"integer","description":"Minimum number of shares required to reconstruct the key","example":3,"format":"int64"},"total_shares":{"type":"integer","description":"Total number of shares to create","example":5,"format":"int64"}},"example":{"min_shares":3,"total_shares":5},"required":["total_shares","min_shares"]},"CreateMasterKeyResponseBody":{"type":"object","properties":{"shares":{"type":"array","items":{"type":"string","example":"Iste et animi explicabo sed."},"description":"The generated key shares","example":["Commodi repudiandae et molestias quasi.","Cupiditate eos et nisi eos beatae.","Eligendi consequatur voluptas."]}},"example":{"shares":["Eos ut.","Sunt ut qui sint sapiente."]}},"CreateUserRequestBody":{"type":"object","properties":{"password":{"type":"string","description":"Password (hashed or plain depending on implementation)","example":"s3cr3t"},"username":{"type":"string","description":"Username of the new user","example":"alice"}},"example":{"password":"s3cr3t","username":"alice"},"required":["username","password"]},"CreateUserResponseBody":{"type":"object","properties":{"username":{"type":"string","description":"The username of the created user","example":"Quos officiis."}},"example":{"username":"Corrupti aut."}},"DeleteShareRequestBody":{"type":"object","properties":{"index":{"type":"integer","description":"The index of the share to delete","example":1,"format":"int64"}},"example":{"index":1},"required":["index"]},"Error":{"type":"object","properties":{"fault":{"type":"boolean","description":"Is the error a server-side fault?","example":true},"id":{"type":"string","description":"ID is a unique identifier for this particular occurrence of the problem.","example":"123abc"},"message":{"type":"string","description":"Message is a human-readable explanation specific to this occurrence of the problem.","example":"parameter 'p' must be an integer"},"name":{"type":"string","description":"Name is the name of this class of errors.","example":"bad_request"},"temporary":{"type":"boolean","description":"Is the error temporary?","example":true},"timeout":{"type":"boolean","description":"Is the error a timeout?","example":true}},"description":"Invalid input","example":{"fault":false,"id":"123abc","message":"parameter 'p' must be an integer","name":"bad_request","temporary":false,"timeout":false},"required":["name","id","message","temporary","timeout","fault"]},"GetKeyStatusResponseBody":{"type":"object","properties":{"current_shares":{"type":"integer","description":"Number of shares currently held","example":5546197956964084782,"format":"int64"},"is_locked":{"type":"boolean","description":"Whether the key is currently locked","example":true},"min_shares":{"type":"integer","description":"Minimum number of shares required","example":1806733679357795195,"format":"int64"},"total_shares":{"type":"integer","description":"Total number of shares","example":5069414871337445786,"format":"int64"}},"example":{"current_shares":4794688918544808155,"is_locked":false,"min_shares":7490492448984177102,"total_shares":5901166280847989925},"required":["is_locked","current_shares","min_shares","total_shares"]},"User":{"type":"object","properties":{"created_at":{"type":"string","description":"User creation timestamp","example":"Autem ut necessitatibus dolor earum aut."},"updated_at":{"type":"string","description":"User last update timestamp","example":"Esse dolores aut quia ea."},"username":{"type":"string","description":"The username","example":"Illo impedit debitis quia."}},"example":{"created_at":"Aperiam nemo et rerum quidem expedita.","updated_at":"Qui quia et similique.","username":"Eum necessitatibus perspiciatis."},"required":["username","created_at","updated_at"]}}},"tags":[{"name":"key_management","description":"The FishyKeys server handles master key operations"},{"name":"users","description":"User service manages user accounts and authentication"}]}